import{bP as $,r as h,a7 as B,t as E,bN as V,w as I,y as q,z as f,A as n,H as k,K as v,P as i,N as b,I as p,aD as g,bO as U,M as C}from"./vue-mr2w3f1M.js";import{u as F,a as d}from"./index-De3j1VZw.js";import{L as M}from"./page-dKwHItdI.js";import{E as N}from"./element-plus-BOnWL2JY.js";import"./vendor-ByJfu4Fc.js";import"./swiper-2AkFM_2d.js";import"./pinia--8Gmfku1.js";import"./axios-DW_MHI2K.js";const T="/assets/bannerMobile-D152lkyX.webp",D="/assets/bannerPc-DbLWUkrr.webp",L="/assets/banner-B1UceERi.webp",P=T,R=D,S={class:""},A={class:"Container MainBox outer"},z={class:"Topic1 text-center mb-8"},K={class:"text"},Z={__name:"index",setup(O){const{t:x}=$(),w=U(),u=V(),_=F(),r=h(""),o=B({username:"",password:""}),l=h(!1);E(()=>{_.userIsLogin&&u.replace("/member")}),I(()=>_.userIsLogin,s=>{s&&u.replace("/member")});const y=async()=>{l.value=!0;let s=null;await d.get("/authentication/token/new").then(e=>{s=e.request_token}),await d.post("/authentication/token/validate_with_login",{request_token:s,username:o.username,password:o.password}).then(e=>{if(r.value="",e.success){let t=new Date;t.setTime(t.getTime()+24*60*60*1e3),t=t.toUTCString(),document.cookie=`token=${e.request_token}; expires=${t}; path=/`,d.post("/authentication/session/new",{request_token:s,username:o.username,password:o.password}).then(a=>{document.cookie=`session_id=${a.session_id}; expires=${t}; path=/`,a.success?d.get("/account",{params:{api_key:"276c2009652cbc7e05302ae2b16c6e07",session_id:a.session_id}}).then(c=>{l.value=!1,_.getUserInfo(c.id,a.session_id),document.cookie=`account_id=${c.id}; expires=${t}; path=/`,N.alert(x("global.loginSuccess"),"",{center:!0,confirmButtonText:"OK",callback:()=>{w.query.from?u.push(w.query.from):u.push({name:"member"})}})}):(r.value=e.response.data.status_message,l.value=!1)})}else r.value=e.response.data.status_message,l.value=!1}).catch(e=>{l.value=!1})};return(s,e)=>{const t=g("ElInput"),a=g("ElFormItem"),c=g("ElForm");return f(),q("div",S,[e[3]||(e[3]=n("picture",{class:"aspect-[23/12] sm:aspect-[32/5]"},[n("source",{srcset:P,media:"(max-width: 575px)"}),n("source",{srcset:R,media:"(max-width: 1920px)"}),n("img",{class:"w-full h-full free object-cover",src:L,alt:"Banner"})],-1)),n("div",A,[n("h1",z,b(s.$t("global.login")),1),i(c,{class:"AccessForm","label-position":"right"},{default:p(()=>[i(a,{label:s.$t("global.account"),"label-position":"top"},{default:p(()=>[i(t,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=m=>o.username=m)},null,8,["modelValue"])]),_:1},8,["label"]),i(a,{label:s.$t("global.password"),"label-position":"top"},{default:p(()=>[i(t,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=m=>o.password=m),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),r.value!==""?(f(),k(a,{key:0},{default:p(()=>[C(b(r.value),1)]),_:1})):v("",!0),n("div",{class:"BtnAny1 default mx-auto",onClick:e[2]||(e[2]=m=>y())},[n("div",K,b(s.$t("global.login")),1)])]),_:1})]),l.value?(f(),k(M,{key:0,class:"absolute top-0 left-0 w-full h-full z-2"})):v("",!0)])}}};export{Z as default};
