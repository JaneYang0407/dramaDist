import{bP as D,r as p,bO as O,a7 as C,c as N,ag as T,w as q,y as d,z as n,A as u,H as x,M as $,N as c,D as w,u as k,P as j,O as E,an as R,aD as z,bN as L}from"./vue-mr2w3f1M.js";import{a as f}from"./index-De3j1VZw.js";import{D as M}from"./item-B5InoV3y.js";import{L as V}from"./page-dKwHItdI.js";import"./vendor-ByJfu4Fc.js";import"./element-plus-BOnWL2JY.js";import"./swiper-2AkFM_2d.js";import"./pinia--8Gmfku1.js";import"./axios-DW_MHI2K.js";const I={class:"MainBox outer Container xl:!px-60"},A={class:"text-white mb-9"},F={class:"text-primary"},H={class:"TabBtnBox mb-10"},K={key:0},S={key:0,class:""},G={class:"grid grid-cols-2 gap-x-6 gap-y-15 xs:grid-cols-2 sm:grid-cols-4 xl:grid-cols-5 mb-10"},J={key:1,class:"text-center text-white"},re={__name:"[type]",setup(Q){const{locale:i}=D(),v=O(),B=L(),l=p(v.query.q),s=p(!0),t=C([]),h=p(1),m=p(0),o=p("movie"),y=N(()=>{if(o.value==="movie")return"movie";if(o.value==="tv")return"show"}),_=async()=>{try{s.value=!0;const e=await f.get(`/search/${o.value}`,{params:{language:i.value,page:h.value,query:l.value}});Object.assign(t,e.results),m.value=e.total_results;for(let a=0;a<t.length;a++)t[a].category=y.value}catch(e){console.error("Error fetching data:",e)}finally{s.value=!1}};T(_),q(i,()=>{_()});async function b(e){s.value=!0,t.length=0,h.value=1,B.push({path:`/search/${e}`,query:{q:l.value}});const a=await f.get(`/search/${e}`,{params:{language:i.value,page:1,query:l.value}});Object.assign(t,a.results),m.value=a.total_results;for(let r=0;r<t.length;r++)t[r].category=y.value;s.value=!1}async function P(e){s.value=!0,t.length=0,h.value=e;const a=await f.get(`/search/${o.value}`,{params:{language:i.value,page:e,query:l.value}});Object.assign(t,a.results),m.value=a.total_results;for(let r=0;r<t.length;r++)t[r].category=y.value;s.value=!1}return q(()=>v.query.q,async()=>{l.value=v.query.q,s.value=!0,t.length=0,await f.get(`/search/${o.value}`,{params:{language:i.value,page:1,query:l.value}}).then(e=>{Object.assign(t,e.results);for(let a=0;a<t.length;a++)t[a].category=y.value;s.value=!1})}),(e,a)=>{const r=z("ElPagination");return n(),d("div",I,[u("div",A,[$(c(e.$t("search.search"))+"「 ",1),u("span",F,c(l.value),1),$(" 」"+c(e.$t("search.result")),1)]),u("div",H,[u("div",{class:w(["TabBtn",{active:k(v).fullPath.indexOf("movie")>-1}]),onClick:a[0]||(a[0]=g=>(b("movie"),o.value="movie"))},c(e.$t("global.movie")),3),u("div",{class:w(["TabBtn",{active:k(v).fullPath.indexOf("tv")>-1}]),onClick:a[1]||(a[1]=g=>(b("tv"),o.value="tv"))},c(e.$t("global.show")),3)]),s.value?(n(),x(V,{key:1,class:"!bg-transparent"})):(n(),d("div",K,[t.length>0?(n(),d("div",S,[u("div",G,[(n(!0),d(E,null,R(t,g=>(n(),x(M,{key:g.id,data:g,category:g.category},null,8,["data","category"]))),128))]),j(r,{layout:"prev, pager, next","current-page":h.value,total:m.value,"pager-count":5,"default-page-size":20,onCurrentChange:P},null,8,["current-page","total"])])):(n(),d("div",J,c(e.$t("global.noData")),1))]))])}}};export{re as default};
