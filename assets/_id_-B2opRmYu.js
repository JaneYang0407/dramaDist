import{bP as L,a7 as T,r as m,ag as N,w as O,y as f,H as I,z as d,A as e,u as r,K as V,N as l,P as j,D as w,O as A,an as F,bO as E,bN as M}from"./vue-mr2w3f1M.js";import{u as W,a as c,g as h}from"./index-De3j1VZw.js";import{s as q}from"./pinia--8Gmfku1.js";import{u as z}from"./apiConfig-Dx1zKg0v.js";import{P as U}from"./item-DPxbh_L8.js";import{L as H}from"./page-dKwHItdI.js";import{a as K,E as b}from"./element-plus-BOnWL2JY.js";import"./vendor-ByJfu4Fc.js";import"./swiper-2AkFM_2d.js";import"./axios-DW_MHI2K.js";const Y={key:0},G={class:"DetailBannerBox"},J={class:"DetailBanner"},Q=["srcset"],X=["srcset"],Z=["src"],ee={class:"DetailBannerInfoBox Container Space"},ae={class:"DetailBannerPoster"},se=["src"],te={class:"DetailBannerInfo"},oe={class:"DetailBannerCategory"},ie={key:0,class:"DetailBannerTag"},le={class:"DetailBannerTitle"},ne={class:"DetailBannerRate"},re={class:"DetailBannerRateNum"},ce={class:"DetailBannerMix"},ue={class:"DetailBannerMixTit"},de={class:"DetailBannerRateBtn"},_e={class:"text"},me={class:"DetailBannerRateScore"},ve={class:"DetailBannerActBox"},pe=["aria-label"],ge=["aria-label"],fe={class:"DetailBannerSlogan"},he={class:"DetailBannerDes"},be={class:"MainBox outer Container"},Be={class:"InfoBlockBox"},$e={class:"InfoBlock"},we={class:"Topic2"},De={class:"flex flex-wrap -mb-5"},ke={class:"InfoBlock"},ye={class:"Topic2"},xe={class:"flex flex-wrap -mb-3.75"},Ve={__name:"[id]",setup(Re){const{locale:D,t:i}=L(),n=E(),R=M(),S=W(),k=T([]),s=T([]),y=m(""),B=m(!1),_=m(0),v=m(!1),p=m(!1),$=m(!0),C=z();C.getApiConfig();const{apiConfig:u}=q(C),P=async()=>{try{$.value=!0;const[o,t]=await Promise.all([c.get(`/movie/${n.params.id}/credits`,{params:{language:D.value}}),c.get(`/movie/${n.params.id}`,{params:{language:D.value}}),,]);if(Object.assign(k,o),Object.assign(s,t),!S.userIsLogin)$.value=!1;else{const a=await c.get(`/movie/${n.params.id}/account_states`,{params:{session_id:h("session_id")}});v.value=a.favorite,p.value=a.watchlist,a.rated!==!1&&a.rated.hasOwnProperty("value")&&(B.value=!0,_.value=a.rated.value)}y.value=s.genres.map(a=>a.name).join("ï¼Ž")}catch(o){console.error("Error fetching data:",o)}finally{$.value=!1}};N(P),O(D,()=>{P()});function x(o){S.userIsLogin?o==="favorite"?c.post(`/account/${h("account_id")}/favorite`,{media_type:"movie",media_id:n.params.id,favorite:!v.value}).then(async t=>{if(t.success){const a=await c.get(`/movie/${n.params.id}/account_states`);v.value=a.favorite;let g=i("global.addFavoriteSuccess");a.favorite||(g=i("global.removeFavoriteSuccess")),b.alert(g,"",{center:!0,confirmButtonText:i("global.confirm")})}}):o==="watchlist"?c.post(`/account/${h("account_id")}/watchlist`,{media_type:"movie",media_id:n.params.id,watchlist:!p.value}).then(async t=>{if(t.success){const a=await c.get(`/movie/${n.params.id}/account_states`);p.value=a.watchlist;let g=i("global.addWatchlistSuccess");a.watchlist||(g=i("global.removeWatchlistSuccess")),b.alert(g,"",{center:!0,confirmButtonText:i("global.confirm")})}}):o==="rate"&&(_.value===0?c.delete(`/movie/${n.params.id}/rating`,{session_id:h("session_id")}).then(async t=>{B.value=!1,b.alert(i("global.resetRateSuccess"),"",{center:!0,confirmButtonText:i("global.confirm")})}):c.post(`/movie/${n.params.id}/rating`,{session_id:h("session_id"),value:_.value}).then(async t=>{B.value=!0,b.alert(i("global.rateSuccess"),"",{center:!0,confirmButtonText:i("global.confirm")})})):b.alert(i("global.pleaseLoginFirst"),"",{center:!0,confirmButtonText:i("global.confirm"),callback:()=>{R.push({name:"login",query:{from:R.currentRoute.value.fullPath}})}})}return(o,t)=>$.value?(d(),I(H,{key:1})):(d(),f("div",Y,[e("div",G,[e("div",J,[e("picture",null,[e("source",{srcset:s.backdrop_path!==""?`${r(u).images.secure_base_url}w300${s.backdrop_path}`:`${r(u).images.secure_base_url}w300${s.poster_path}`,media:"(max-width: 575px)"},null,8,Q),e("source",{srcset:s.backdrop_path!==""?`${r(u).images.secure_base_url}original${s.backdrop_path}`:`${r(u).images.secure_base_url}w1280${s.poster_path}`,media:"(max-width: 1920px)"},null,8,X),e("img",{class:"w-full h-full free object-cover",src:s.backdrop_path!==""?`${r(u).images.secure_base_url}original${s.backdrop_path}`:`${r(u).images.secure_base_url}w342${s.poster_path}`,alt:"Banner"},null,8,Z)])]),e("div",ee,[e("div",ae,[e("img",{src:s.poster_path!==""?`${r(u).images.secure_base_url}w342${s.poster_path}`:`${r(u).images.secure_base_url}w300${s.backdrop_path}`,alt:"Poster"},null,8,se)]),e("div",te,[e("div",oe,l(o.$t("global.movie")),1),y.value!==""?(d(),f("div",ie,l(y.value),1)):V("",!0),e("h1",le,l(s.name),1),e("div",ne,[t[4]||(t[4]=e("i",{class:"icon icon-starFill"},null,-1)),e("div",re,l(s.vote_average),1)]),e("div",ce,[e("div",ue,[e("div",de,[e("div",_e,l(o.$t("global.myRate"))+":",1)]),e("div",me,l(B.value?_.value:o.$t("global.notRateYet")),1)]),j(r(K),{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),max:10,clearable:"",onChange:t[1]||(t[1]=a=>x("rate"))},null,8,["modelValue"])]),e("div",ve,[e("button",{type:"button",class:w(["DetailBannerAct BtnAny0",v.value?"active":""]),"aria-label":o.$t("global.addFavorite"),onClick:t[2]||(t[2]=a=>x("favorite"))},[e("i",{class:w(["icon",v.value?"icon-heartFill":"icon-heart"])},null,2)],10,pe),e("button",{type:"button",class:w(["DetailBannerAct BtnAny0",p.value?"active":""]),"aria-label":o.$t("global.addWatchlist"),onClick:t[3]||(t[3]=a=>x("watchlist"))},[e("i",{class:w(["icon",p.value?"icon-listFill":"icon-list"])},null,2)],10,ge)]),e("div",fe,l(s.tagline),1),e("p",he,l(s.overview),1)])])]),e("div",be,[e("div",Be,[e("div",$e,[e("h2",we,l(o.$t("global.castList")),1),e("div",De,[(d(!0),f(A,null,F(k.cast,a=>(d(),I(U,{key:a.id,data:a},null,8,["data"]))),128))])]),e("div",ke,[e("h2",ye,l(o.$t("global.staffList")),1),e("div",xe,[(d(!0),f(A,null,F(k.crew,a=>(d(),f("div",{key:a.id,class:"InfoName"},l(a.name),1))),128))])])])])]))}};export{Ve as default};
