import{y as v,z as r,K as N,A as a,u as c,N as o,D as x,bP as V,a7 as L,r as g,ag as E,w as M,H as T,P as W,O as S,an as P,bO as q,bN as z}from"./vue-mr2w3f1M.js";import{_ as U,u as H,a as u,g as D}from"./index-De3j1VZw.js";import{s as O}from"./pinia--8Gmfku1.js";import{u as j}from"./apiConfig-Dx1zKg0v.js";import{P as K}from"./item-DPxbh_L8.js";import{L as Y}from"./page-dKwHItdI.js";import{a as G,E as w}from"./element-plus-BOnWL2JY.js";import"./vendor-ByJfu4Fc.js";import"./swiper-2AkFM_2d.js";import"./axios-DW_MHI2K.js";const J={class:"DramaInfoBox relative md:flex"},Q={key:0,class:"DramaInfoPic overflow-hidden"},X=["src"],Z={class:"DramaInfoTop flex items-center mb-1"},aa={class:"DramaInfoTitle font-bold mr-2"},ea={class:"DramaInfoTag text-sm"},sa={class:"DramaInfoTag text-sm"},ta={class:"DramaInfoRate flex items-center mb-6"},oa={class:"DramaInfoRateNum text-sm"},ia={class:"DramaInfoDes text-sm"},la={__name:"info",props:{data:{type:Object,required:!0}},setup(_){const d=_,l=j();l.getApiConfig();const{apiConfig:n}=O(l);return(h,f)=>(r(),v("div",J,[d.data.poster_path!==""&&d.data.poster_path!==null?(r(),v("div",Q,[a("img",{src:`${c(n).images.secure_base_url}w154${d.data.poster_path}`,loading:"lazy",alt:""},null,8,X)])):N("",!0),a("div",{class:x(["DramaInfo",d.data.poster_path===""||d.data.poster_path===null?"self":""])},[a("div",Z,[a("div",aa,o(_.data.name),1),a("div",ea,o(_.data.episode_count)+" "+o(_.data.episode_count>1?h.$t("global.episodes"):h.$t("global.episode")),1),f[0]||(f[0]=a("div",{class:"DramaInfoDecor text-sm"},"．",-1)),a("div",sa,o(_.data.air_date),1)]),a("div",ta,[f[1]||(f[1]=a("i",{class:"icon icon-starFill text-xs mr-1"},null,-1)),a("div",oa,o(_.data.vote_average),1)]),a("div",ia,o(_.data.overview),1)],2)]))}},na=U(la,[["__scopeId","data-v-d6b3d492"]]),ra={key:0},ca={class:"DetailBannerBox"},da={class:"DetailBanner"},ua=["srcset"],_a=["srcset"],ma=["src"],va={class:"DetailBannerInfoBox Container Space"},fa={class:"DetailBannerPoster"},pa=["src"],ga={class:"DetailBannerInfo"},ha={class:"DetailBannerCategory"},ba={key:0,class:"DetailBannerTag"},$a={class:"DetailBannerTitle"},Ba={class:"DetailBannerRate"},Da={class:"DetailBannerRateNum"},wa={class:"DetailBannerMix"},xa={class:"DetailBannerMixTit"},ya={class:"DetailBannerRateBtn"},ka={class:"text"},Ia={class:"DetailBannerRateScore"},Ra={class:"DetailBannerActBox"},Ca=["aria-label"],Ta=["aria-label"],Sa={class:"DetailBannerSlogan"},Pa={class:"DetailBannerDes"},Aa={class:"MainBox outer Container"},Fa={class:"InfoBlockBox"},La={class:"InfoBlock"},Na={class:"Topic2"},Oa={class:"flex flex-wrap -mb-5"},ja={class:"InfoBlock"},Va={class:"Topic2"},Ea={class:"flex flex-wrap -mb-3.75"},Ma={class:"InfoBlock"},Wa={class:"Topic2"},qa={class:"grid gap-5 xl:grid-cols-2"},ae={__name:"[id]",setup(_){const{locale:d,t:l}=V(),n=q(),h=z(),f=H(),I=L([]),s=L([]),R=g(""),y=g(!1),p=g(0),b=g(!1),$=g(!1),k=g(!0),A=j();A.getApiConfig();const{apiConfig:m}=O(A),F=async()=>{try{k.value=!0;const[i,t]=await Promise.all([u.get(`/tv/${n.params.id}/credits`,{params:{language:d.value}}),u.get(`/tv/${n.params.id}`,{params:{language:d.value}}),,]);if(Object.assign(I,i),Object.assign(s,t),!f.userIsLogin)k.value=!1;else{const e=await u.get(`/tv/${n.params.id}/account_states`,{params:{session_id:D("session_id")}});b.value=e.favorite,$.value=e.watchlist,e.rated!==!1&&e.rated.hasOwnProperty("value")&&(y.value=!0,p.value=e.rated.value)}R.value=s.genres.map(e=>e.name).join("．")}catch(i){console.error("Error fetching data:",i)}finally{k.value=!1}};E(F),M(d,()=>{F()});function C(i){f.userIsLogin?i==="favorite"?u.post(`/account/${D("account_id")}/favorite`,{media_type:"tv",media_id:n.params.id,favorite:!b.value}).then(async t=>{if(t.success){const e=await u.get(`/tv/${n.params.id}/account_states`);b.value=e.favorite;let B=l("global.addFavoriteSuccess");e.favorite||(B=l("global.removeFavoriteSuccess")),w.alert(B,"",{center:!0,confirmButtonText:l("global.confirm")})}}):i==="watchlist"?u.post(`/account/${D("account_id")}/watchlist`,{media_type:"tv",media_id:n.params.id,watchlist:!$.value}).then(async t=>{if(t.success){const e=await u.get(`/tv/${n.params.id}/account_states`);$.value=e.watchlist;let B=l("global.addWatchlistSuccess");e.watchlist||(B=l("global.removeWatchlistSuccess")),w.alert(B,"",{center:!0,confirmButtonText:l("global.confirm")})}}):i==="rate"&&(p.value===0?u.delete(`/tv/${n.params.id}/rating`,{session_id:D("session_id")}).then(async t=>{y.value=!1,w.alert(l("global.resetRateSuccess"),"",{center:!0,confirmButtonText:l("global.confirm")})}):u.post(`/tv/${n.params.id}/rating`,{session_id:D("session_id"),value:p.value}).then(async t=>{y.value=!0,w.alert(l("global.rateSuccess"),"",{center:!0,confirmButtonText:l("global.confirm")})})):w.alert(l("global.pleaseLoginFirst"),"",{center:!0,confirmButtonText:l("global.confirm"),callback:()=>{h.push({name:"login",query:{from:h.currentRoute.value.fullPath}})}})}return(i,t)=>k.value?(r(),T(Y,{key:1})):(r(),v("div",ra,[a("div",ca,[a("div",da,[a("picture",null,[a("source",{srcset:s.backdrop_path!==""?`${c(m).images.secure_base_url}w300${s.backdrop_path}`:`${c(m).images.secure_base_url}w300${s.poster_path}`,media:"(max-width: 575px)"},null,8,ua),a("source",{srcset:s.backdrop_path!==""?`${c(m).images.secure_base_url}original${s.backdrop_path}`:`${c(m).images.secure_base_url}w1280${s.poster_path}`,media:"(max-width: 1920px)"},null,8,_a),a("img",{class:"w-full h-full free object-cover",src:s.backdrop_path!==""?`${c(m).images.secure_base_url}original${s.backdrop_path}`:`${c(m).images.secure_base_url}w342${s.poster_path}`,alt:"Banner"},null,8,ma)])]),a("div",va,[a("div",fa,[a("img",{src:s.poster_path!==""?`${c(m).images.secure_base_url}w342${s.poster_path}`:`${c(m).images.secure_base_url}w300${s.backdrop_path}`,alt:"Poster"},null,8,pa)]),a("div",ga,[a("div",ha,o(i.$t("global.show")),1),R.value!==""?(r(),v("div",ba,o(R.value),1)):N("",!0),a("h1",$a,o(s.name),1),a("div",Ba,[t[4]||(t[4]=a("i",{class:"icon icon-starFill"},null,-1)),a("div",Da,o(s.vote_average),1)]),a("div",wa,[a("div",xa,[a("div",ya,[a("div",ka,o(i.$t("global.myRate"))+":",1)]),a("div",Ia,o(y.value?p.value:i.$t("global.notRateYet")),1)]),W(c(G),{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),max:10,clearable:"",onChange:t[1]||(t[1]=e=>C("rate"))},null,8,["modelValue"])]),a("div",Ra,[a("button",{type:"button",class:x(["DetailBannerAct BtnAny0",b.value?"active":""]),"aria-label":i.$t("global.addFavorite"),onClick:t[2]||(t[2]=e=>C("favorite"))},[a("i",{class:x(["icon",b.value?"icon-heartFill":"icon-heart"])},null,2)],10,Ca),a("button",{type:"button",class:x(["DetailBannerAct BtnAny0",$.value?"active":""]),"aria-label":i.$t("global.addWatchlist"),onClick:t[3]||(t[3]=e=>C("watchlist"))},[a("i",{class:x(["icon",$.value?"icon-listFill":"icon-list"])},null,2)],10,Ta)]),a("div",Sa,o(s.tagline),1),a("p",Pa,o(s.overview),1)])])]),a("div",Aa,[a("div",Fa,[a("div",La,[a("h2",Na,o(i.$t("global.castList")),1),a("div",Oa,[(r(!0),v(S,null,P(I.cast,e=>(r(),T(K,{key:e.id,data:e},null,8,["data"]))),128))])]),a("div",ja,[a("h2",Va,o(i.$t("global.staffList")),1),a("div",Ea,[(r(!0),v(S,null,P(I.crew,e=>(r(),v("div",{key:e.id,class:"InfoName"},o(e.name),1))),128))])]),a("div",Ma,[a("h2",Wa,o(i.$t("global.allSeasons")),1),a("div",qa,[(r(!0),v(S,null,P(s.seasons,e=>(r(),T(na,{key:e.id,data:e,class:"cursor-context-menu"},null,8,["data"]))),128))])])])])]))}};export{ae as default};
